{
  "description": "On the Tasks page, the todo list items display correctly under all filters. However, when switching to the 'Active' or 'Completed' filter, the entire sidebar breaks: the 'All Tasks' count drops to only the filtered count, the opposite filter shows 0, the progress bar jumps to 0% or 100% incorrectly, and the 'Total Tasks' stat card shows the wrong number. Switching back to 'All Tasks' makes everything look correct again. The header text also shows the wrong total (e.g., '5 tasks in total' when there are actually 12). Toggling a todo's completion while on a filter view makes it vanish from the list without the counts adjusting properly.",
  "expectedOutcome": "Regardless of which filter is selected, the sidebar should always show the correct total task count, the correct number of active and completed tasks, and an accurate progress percentage. The filter should only affect which tasks appear in the main list — not the aggregate stats in the sidebar.",
  "hint": "The component's counting logic looks correct — it filters todos for active and completed counts. But what exactly is it counting? Trace where the 'todos' array comes from. Is the component receiving ALL the todos, or has something already narrowed the dataset before the component even sees it?",
  "difficulty": "Medium",
  "bugFilePath": "src/hooks/useTodos.js",
  "solution": "The useTodos custom hook was refactored to pre-filter the todos array using useMemo based on the current filter value before returning it. The component (TodoManager) expects to receive the FULL unfiltered list of todos so it can independently calculate total counts, active counts, completed counts, completion rate, and then separately filter the list for display. Because the hook now returns a pre-filtered array as 'todos', every downstream calculation in the component (todos.length, todos.filter(t => !t.completed), todos.filter(t => t.completed)) operates on the already-filtered subset instead of the full dataset. This causes all sidebar stats, filter badge counts, progress bars, and header text to show incorrect values whenever a filter other than 'all' is active. The fix is to remove the useMemo filtering from the hook and return allTodos directly, letting the component handle its own filtering as it was designed to do.",
  "solutionCode": "export function useTodos() {\n  const dispatch = useDispatch()\n  const { items: todos, filter, editingId } = useSelector((state) => state.todos)\n\n  return {\n    todos,\n    filter,\n    editingId,\n    addTodo: (text) => dispatch(addTodo(text)),\n    toggleComplete: (id) => dispatch(toggleComplete(id)),\n    deleteTodo: (id) => dispatch(deleteTodo(id)),\n    updateTodo: (payload) => dispatch(updateTodo(payload)),\n    setFilter: (value) => dispatch(setFilter(value)),\n    setEditingId: (id) => dispatch(setEditingId(id)),\n    clearCompleted: () => dispatch(clearCompleted()),\n  }\n}"
}
